name: Migrate Simulator to Supabase
tasks:
  - id: audit-simulator
    description: Audit current Simulator implementation
    prompt: |
      In Edge Oracle, audit the Simulator page:

      1. Review src/pages/Simulator.jsx thoroughly
      2. List ALL Firebase/Firestore imports and queries
      3. Document what data it fetches (workflows, SOPs, procedures, resource_pools)
      4. Check what Supabase tables exist for this data
      5. Create ./audit/simulator-audit.md with findings

      Do not ask questions - just do it.

  - id: create-simulator-service
    description: Create Supabase simulator service
    prompt: |
      In Edge Oracle, create a Supabase service for the Simulator:

      1. Create src/services/simulatorServiceSupabase.ts
      2. Add functions to fetch:
         - getWorkflows(organizationId, departmentId?)
         - getSOPs(organizationId, departmentId?)
         - getProcedures(organizationId, departmentId?)
         - getResourcePools(organizationId, departmentId?)
      3. Use proper TypeScript types from src/lib/supabase/types.ts
      4. Add error handling and loading states
      5. Filter by organization_id from user context

      Do not ask questions - just do it.

  - id: migrate-simulator-queries
    description: Replace Firebase queries with Supabase
    prompt: |
      In Edge Oracle, migrate Simulator.jsx to Supabase:

      1. Remove ALL Firebase/Firestore imports
      2. Import the new simulatorServiceSupabase
      3. Replace Firestore queries with Supabase service calls
      4. Use useSupabaseAuth() for user/organization context
      5. Keep the simulation engine logic intact
      6. Update state management to work with new data format

      Do not ask questions - just do it.

  - id: add-loading-states
    description: Add proper loading and error states
    prompt: |
      In Edge Oracle, improve Simulator UX:

      1. Add loading skeletons while data fetches
      2. Add error boundary/error states
      3. Add empty states if no workflows/SOPs exist
      4. Show helpful message to create workflows if none found
      5. Ensure graceful degradation

      Do not ask questions - just do it.

  - id: verify-simulator
    description: Verify Simulator works
    prompt: |
      In Edge Oracle, verify the Simulator migration:

      1. Run: npm run build - fix any errors
      2. Search for remaining Firebase imports in Simulator:
         grep -n "firebase" src/pages/Simulator.jsx
         grep -n "firestore" src/pages/Simulator.jsx
      3. Remove any found Firebase references
      4. Update ./audit/simulator-audit.md with completion status
      5. List any issues that need manual testing

      Do not ask questions - just do it.
